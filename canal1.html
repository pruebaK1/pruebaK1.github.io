<!DOCTYPE html>
<html>
<head>
<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: black;
}
#iframePlayer {
    border: 0;
    width: 100%;
    height: 100%;
}
</style>
</head>
<body>

<iframe id="iframePlayer" allow="autoplay; fullscreen"></iframe>

<script>
function getParam(name) {
    return new URLSearchParams(window.location.search).get(name);
}

let encoded = getParam("r");
if (!encoded) throw "No r param";

encoded = encoded.replace(/-/g,'+').replace(/_/g,'/');
while (encoded.length % 4) encoded += '=';

let url = atob(encoded);
let iframe = document.getElementById("iframePlayer");

let loaded = false;

// Cargar solo una vez
function loadPlayer() {
    iframe.src = url + (url.includes("?") ? "&" : "?") + "autoplay=1";
}
loadPlayer();

// Detecta si carg√≥
iframe.onload = () => {
    loaded = true;
};

// üî• OBS FIX: solo un reload inicial (NO LOOP)
if (!sessionStorage.getItem("obs_fix")) {
    sessionStorage.setItem("obs_fix", "1");
    setTimeout(() => location.reload(), 2000);
}

// ‚ùå NO recargar autom√°tico nunca (mata streams con token)
</script>

</body>
</html>
